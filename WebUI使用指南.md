# 模组OCR优化器 Web UI 使用指南

## 概述

Web UI版本提供了友好的浏览器界面，无需命令行操作即可完成模组OCR识别和组合优化计算。

## 功能特性

### 🎯 核心功能
- **可视化操作界面**: 无需命令行，在浏览器中完成所有操作
- **实时进度显示**: 计算过程中显示详细进度和当前步骤
- **美观结果展示**: 分组显示最优组合方案，支持筛选查看
- **响应式设计**: 支持桌面和移动设备访问

### 📊 界面功能
- **控制面板**: 检查截图状态，一键开始计算
- **计算概要**: 显示识别模组数、有效组合数、最高收益等统计信息
- **模组展示**: 网格形式展示所有识别到的模组及其属性
- **组合方案**: 按属性最大化分组，显示详细的模组组合方案
- **智能筛选**: 支持按组合类型筛选查看结果

## 安装和启动

### 方法一：自动启动（推荐）
```cmd
双击运行 start_webui.bat
```

### 方法二：手动启动
1. **安装Web UI依赖**:
   ```cmd
   pip install Flask==2.3.3 Flask-CORS==4.0.0
   ```

2. **启动Web服务器**:
   ```cmd
   python web_app.py
   ```

3. **打开浏览器访问**:
   ```
   http://localhost:5000
   ```

## 使用流程

### 1. 准备截图文件
- 确保 `screenshot/` 文件夹中包含模组截图
- 支持格式: PNG, JPG, JPEG
- 截图要求清晰，属性名称和数值完整可见

### 2. 启动Web界面
- 运行 `start_webui.bat` 或手动启动
- 浏览器会自动打开并显示界面
- 界面会自动检查截图文件夹状态

### 3. 执行计算
- 点击"开始OCR识别和优化计算"按钮
- 观察实时进度条和当前执行步骤
- 等待计算完成（通常需要30秒-2分钟）

### 4. 查看结果
- **概要信息**: 顶部显示总体统计数据
- **识别模组**: 查看所有识别到的模组及属性
- **最优组合**: 按属性分组显示最佳方案
- **筛选功能**: 使用下拉菜单筛选特定组合类型

## 界面说明

### 控制面板
```
📁 截图文件夹状态: 就绪 (9 张截图)
🚀 开始OCR识别和优化计算
📊 进度条: [████████████████] 100%
```

### 计算概要
```
┌─────────────┬─────────────┬─────────────┬─────────────┐
│  识别模组数  │  有效组合数  │   最高收益   │   计算用时   │
│      9      │     156     │     58      │   2.34s    │
└─────────────┴─────────────┴─────────────┴─────────────┘
```

### 组合展示示例
```
⭐ 力量加持+智力加持 最大化组合 (15个方案)

方案 1                                    📊 58 总收益
┌─────────────────────────────────────────────────────┐
│ 模组组合 (3/4): 模组A + 模组B + 模组C                │
│                                                     │
│ 属性详情:                                           │
│ 力量加持: 20 (20/20) ⚡                             │
│ 智力加持: 20 (20/20) ⚡                             │
│ 敏捷加持: 18 (18/20)                               │
└─────────────────────────────────────────────────────┘
```

## 高级功能

### 分组筛选
- **所有组合**: 显示所有结果
- **单属性最大化**: 如"力量加持"、"智力加持"等
- **双属性最大化**: 如"力量加持+智力加持"
- **三属性最大化**: 如"力量加持+智力加持+敏捷加持"

### 结果解读
- **🔴 红色数值**: 达到20点上限的属性
- **🟢 绿色数值**: 未达到上限但有效的属性
- **模组标签**: 紫色标签显示组合中的模组
- **效率显示**: 格式为"当前值/最大值"

## 故障排除

### 问题1: 浏览器无法打开界面
**解决方案**:
- 检查Flask是否正确安装: `pip install Flask`
- 确认端口5000未被占用
- 手动访问: `http://localhost:5000`

### 问题2: "开始计算"按钮禁用
**可能原因**:
- screenshot文件夹不存在或为空
- 图片格式不支持
- 服务器连接问题

**解决方案**:
- 检查screenshot文件夹中是否有图片文件
- 刷新页面重新检查状态

### 问题3: 计算过程中断
**可能原因**:
- OCR依赖未正确安装
- Tesseract OCR配置问题
- 图片质量过低无法识别

**解决方案**:
- 确认已安装Tesseract OCR及中文语言包
- 检查环境变量PATH配置
- 尝试更换更清晰的截图

### 问题4: 结果显示异常
**解决方案**:
- 刷新浏览器页面
- 检查浏览器控制台是否有JavaScript错误
- 清除浏览器缓存后重试

## 技术规格

### 系统要求
- **操作系统**: Windows 7+ / macOS / Linux
- **浏览器**: Chrome 80+, Firefox 75+, Safari 13+, Edge 80+
- **Python**: 3.8+
- **内存**: 建议4GB以上

### 网络要求
- **本地运行**: 无需网络连接
- **CDN资源**: Font Awesome图标库需要网络（可离线使用）

### 性能参数
- **启动时间**: 2-5秒
- **计算速度**: 9张截图约2-3分钟
- **内存占用**: 约200-500MB
- **CPU负载**: 计算期间50-80%

## API接口

Web UI基于REST API构建，主要接口：

```
GET  /                      # 主页面
POST /api/start_calculation # 启动计算
GET  /api/calculation_status # 获取计算状态
GET  /api/results           # 获取计算结果
GET  /api/screenshot_info   # 截图文件夹信息
```

## 开发和自定义

### 文件结构
```
web_app.py              # Flask应用主文件
templates/
  └── index.html        # HTML模板
static/
  ├── css/
  │   └── style.css     # 样式文件
  └── js/
      └── app.js        # JavaScript应用逻辑
```

### 自定义样式
- 修改 `static/css/style.css` 自定义界面样式
- 支持CSS变量，便于主题定制
- 响应式设计，自动适配不同设备

### 扩展功能
- 添加新的API接口到 `web_app.py`
- 扩展前端功能到 `static/js/app.js`
- 支持多语言界面（需要修改模板）

## 注意事项

1. **端口占用**: 默认使用5000端口，如被占用请修改代码
2. **文件权限**: 确保对screenshot文件夹有读取权限
3. **浏览器兼容**: 建议使用现代浏览器获得最佳体验
4. **资源占用**: 大量截图会增加计算时间和内存占用
5. **结果保存**: Web UI版本同样会生成JSON结果文件

## 联系支持

如需技术支持，请提供：
- 浏览器版本和类型
- 错误信息截图
- 计算日志输出
- 操作系统版本
