---
globs: *.bat,*.md
description: Windows部署和使用指南
---

# Windows部署和使用指南

## 自动化脚本

### 环境安装 ([install_windows.bat](mdc:install_windows.bat))

自动检测和安装依赖：
- Python环境检查
- pip包安装
- Tesseract OCR验证
- 中文语言包检查

### 应用启动

- [run_ocr.bat](mdc:run_ocr.bat) - 命令行版本
- [start_webui.bat](mdc:start_webui.bat) - Web UI版本（推荐）

## 依赖要求

### Python包 ([requirements.txt](mdc:requirements.txt))

```
numpy<2.0.0          # 版本兼容性限制
opencv-python>=4.8.0 # 图像处理
pytesseract>=0.3.10  # OCR引擎接口
Pillow>=10.0.0       # 图像库
Flask>=2.0.0         # Web框架
Flask-CORS>=4.0.0    # 跨域支持
```

### 外部依赖

**Tesseract OCR引擎**：
- 下载地址：https://github.com/UB-Mannheim/tesseract/wiki
- 必需组件：中文简体语言包
- 环境变量：添加安装路径到系统PATH

## 故障排除

### 常见问题

1. **NumPy版本冲突**：`numpy.core.multiarray failed to import`
   - 解决：`pip install "numpy<2.0.0"`

2. **Tesseract未找到**：`tesseract is not installed`  
   - 解决：检查PATH环境变量或代码自动检测

3. **端口占用**：`Address already in use`
   - 解决：修改web_app.py中的端口号

4. **OCR识别率低**：
   - 确保截图清晰度
   - 检查中文语言包安装
   - 验证属性名称在支持列表中

## 文件传输清单

**最小文件集**：
- 核心程序：[module_ocr_optimizer.py](mdc:module_ocr_optimizer.py), [web_app.py](mdc:web_app.py)
- 配置文件：[requirements.txt](mdc:requirements.txt)
- 启动脚本：[start_webui.bat](mdc:start_webui.bat)
- Web资源：`templates/`, `static/`文件夹
- 数据文件：`screenshot/`文件夹及截图